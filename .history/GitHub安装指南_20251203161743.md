# 从 GitHub 安装扩展包指南

本指南说明如何从 GitHub 下载并安装 `isaaclab_logistics_vla` 扩展包到你的 IsaacLab 项目中。

---

## 📋 前置要求

在使用本扩展包之前，请确保：

1. ✅ **已安装 IsaacLab 2.2.1**
   - 确保 IsaacLab 已经正确安装在你的系统上
   - 知道你的 IsaacLab 安装路径（例如：`/home/user/IsaacLab-2.2.1`）

2. ✅ **Git 工具**（如果使用 git clone 方式）
   ```bash
   # 如果没有 Git，安装它（Linux）
   sudo apt-get install git
   ```

3. ✅ **网络连接**（用于从 GitHub 下载）

---

## 🚀 快速开始

### 方式一：使用 Git Clone（推荐）

如果你熟悉 Git 并计划参与开发，推荐使用此方式：

```bash
# 1. 进入 IsaacLab 的 source 目录
cd /path/to/IsaacLab-2.2.1/source

# 2. 克隆扩展包仓库
git clone https://github.com/your-org/isaaclab_logistics_vla.git

# 3. 返回 IsaacLab 根目录
cd ..

# 4. 安装扩展包
./isaaclab.sh -p -m pip install -e source/isaaclab_logistics_vla
```

### 方式二：下载 ZIP 文件

如果你不需要 Git 历史记录，可以直接下载 ZIP：

```bash
# 1. 从 GitHub 下载 ZIP 文件
# 在浏览器中访问：https://github.com/your-org/isaaclab_logistics_vla
# 点击 "Code" -> "Download ZIP"

# 2. 解压到 IsaacLab 的 source 目录
cd /path/to/IsaacLab-2.2.1/source
unzip ~/Downloads/isaaclab_logistics_vla-main.zip
mv isaaclab_logistics_vla-main isaaclab_logistics_vla

# 3. 返回 IsaacLab 根目录并安装
cd ..
./isaaclab.sh -p -m pip install -e source/isaaclab_logistics_vla
```

---

## 📝 详细安装步骤

### 步骤 1：定位 IsaacLab 安装目录

首先，找到你的 IsaacLab 安装路径：

```bash
# 假设 IsaacLab 安装在 /home/user/IsaacLab-2.2.1
cd /home/user/IsaacLab-2.2.1

# 确认你在正确的目录（应该能看到 isaaclab.sh 文件）
ls isaaclab.sh
```

### 步骤 2：下载扩展包

#### 方法 A：Git Clone（推荐）

```bash
# 进入 source 目录
cd source

# 克隆仓库
git clone https://github.com/your-org/isaaclab_logistics_vla.git

# 查看克隆的目录
ls -la isaaclab_logistics_vla/

# 返回 IsaacLab 根目录
cd ..
```

#### 方法 B：下载 ZIP 文件

```bash
# 1. 在浏览器中访问 GitHub 仓库页面
# https://github.com/your-org/isaaclab_logistics_vla

# 2. 点击绿色的 "Code" 按钮
# 3. 选择 "Download ZIP"
# 4. 下载到你的下载目录（例如 ~/Downloads/）

# 5. 在终端中解压并移动到正确位置
cd source
unzip ~/Downloads/isaaclab_logistics_vla-main.zip
mv isaaclab_logistics_vla-main isaaclab_logistics_vla
cd ..
```

### 步骤 3：安装扩展包

使用 IsaacLab 的 Python 环境安装扩展包：

```bash
# 确保在 IsaacLab 根目录
cd /path/to/IsaacLab-2.2.1

# 安装扩展包（可编辑模式）
./isaaclab.sh -p -m pip install -e source/isaaclab_logistics_vla
```

**命令详解：**

- `./isaaclab.sh`：IsaacLab 启动脚本，用于管理 Python 环境和路径
- `-p`：使用 IsaacLab 管理的 Python 环境（而不是系统 Python）
  - ✅ 确保使用正确的 Python 版本
  - ✅ 包含所有必需的库路径
  - ✅ 环境变量正确配置
- `-m pip`：以 Python 模块方式运行 pip 安装工具
- `install -e`：以**可编辑模式**安装（`-e` = editable）
  - ✅ 修改代码后无需重新安装
  - ✅ 代码更改立即生效
  - ✅ 开发时非常方便
- `source/isaaclab_logistics_vla`：扩展包在 IsaacLab 中的相对路径

**如果已激活 conda 环境，也可以使用：**

```bash
conda activate env_isaaclab  # 激活 IsaacLab 的 conda 环境
pip install -e source/isaaclab_logistics_vla
```

### 步骤 4：验证安装

安装完成后，验证扩展包是否可以正常导入：

```bash
# 方式 1：快速测试导入
./isaaclab.sh -p -c "import isaaclab_logistics_vla; print('✅ 扩展包安装成功！')"

# 方式 2：交互式 Python 测试
./isaaclab.sh -p
```

在 Python 交互式环境中：

```python
>>> import isaaclab_logistics_vla
>>> import gymnasium as gym

# 列出所有已注册的任务（如果实现了这个功能）
# 或者直接尝试创建一个环境
>>> env = gym.make("Isaac-Realman-lift")
>>> print("✅ 环境创建成功！")
```

### 步骤 5：测试运行任务

使用统一入口脚本测试任务是否能正常运行：

```bash
# 测试 Realman-lift 任务（如果有显示设备）
./isaaclab.sh -p source/isaaclab_logistics_vla/random_agent.py \
    --task Isaac-Realman-lift \
    --num_envs 1

# 无头模式测试（无显示设备）
./isaaclab.sh -p source/isaaclab_logistics_vla/random_agent.py \
    --task Isaac-Realman-lift \
    --num_envs 1 \
    --headless
```

---

## 📂 最终目录结构

安装完成后，你的目录结构应该是：

```
IsaacLab-2.2.1/
├── isaaclab.sh                      # IsaacLab 启动脚本
├── source/
│   └── isaaclab_logistics_vla/      # ← 扩展包在这里
│       ├── setup.py
│       ├── config/
│       │   └── extension.toml
│       ├── isaaclab_logistics_vla/
│       │   ├── __init__.py
│       │   └── tasks/
│       │       ├── realman_lift/
│       │       └── ...
│       ├── random_agent.py          # 统一入口脚本
│       └── ...
└── ...
```

---

## 🔄 更新扩展包

如果扩展包在 GitHub 上有更新，你需要拉取最新代码：

```bash
# 进入扩展包目录
cd /path/to/IsaacLab-2.2.1/source/isaaclab_logistics_vla

# 拉取最新代码（如果使用 git clone）
git pull origin main

# 如果有新的依赖或代码变更，重新安装（可选但推荐）
cd /path/to/IsaacLab-2.2.1
./isaaclab.sh -p -m pip install -e source/isaaclab_logistics_vla --upgrade
```

---

## ❓ 常见问题

### Q1: 为什么要使用 `./isaaclab.sh -p` 而不是直接 `pip`？

**A:** IsaacLab 使用特定的 Python 环境（包含 Isaac Sim），`isaaclab.sh -p` 确保：
- ✅ 使用正确的 Python 版本和路径
- ✅ 包含所有必需的库路径（Isaac Sim、Omniverse 等）
- ✅ 环境变量正确配置（`ISAACLAB_PATH`、`CARB_APP_PATH` 等）
- ✅ 避免与系统 Python 环境冲突

### Q2: `-e` 参数是什么意思？可以不用吗？

**A:** `-e` 表示**可编辑模式（editable mode）**安装：
- ✅ **推荐使用**：修改代码后无需重新安装，更改立即生效
- ✅ 开发时非常方便
- ❌ 如果使用 `pip install source/isaaclab_logistics_vla`（不带 `-e`），每次代码更改都需要重新安装

### Q3: 必须放在 `source/` 目录下吗？

**A:** 不是必须的，但**强烈推荐**：
- ✅ 符合 IsaacLab 的扩展包组织结构
- ✅ 便于管理和查找
- ✅ 与其他扩展包保持一致
- ✅ 路径清晰，不容易出错

你可以放在任何位置，只需要使用绝对路径：
```bash
./isaaclab.sh -p -m pip install -e /绝对路径/到/isaaclab_logistics_vla
```

### Q4: 安装失败怎么办？

**检查清单：**

1. ✅ 确认在正确的目录（IsaacLab 根目录）
2. ✅ 确认扩展包路径正确（`source/isaaclab_logistics_vla` 存在）
3. ✅ 确认 `isaaclab.sh` 有执行权限：`chmod +x isaaclab.sh`
4. ✅ 检查网络连接（如果需要下载依赖）
5. ✅ 查看错误信息，可能需要安装额外依赖

**常见错误及解决：**

**错误 1：`ModuleNotFoundError: No module named 'isaaclab'`**
```bash
# 解决：确保 IsaacLab 环境正确设置
./isaaclab.sh --install
```

**错误 2：`Permission denied: isaaclab.sh`**
```bash
# 解决：添加执行权限
chmod +x isaaclab.sh
```

**错误 3：`ERROR: Directory 'source/isaaclab_logistics_vla' is not installable`**
```bash
# 解决：确认目录存在，并且包含 setup.py
ls source/isaaclab_logistics_vla/setup.py
```

### Q5: 安装后如何卸载？

**A:** 
```bash
./isaaclab.sh -p -m pip uninstall isaaclab_logistics_vla
```

然后可以选择删除目录：
```bash
rm -rf source/isaaclab_logistics_vla
```

### Q6: 多人协作时，每个人都需要安装吗？

**A:** 是的，每个开发者都需要：
1. ✅ 克隆或下载扩展包到自己的 IsaacLab `source/` 目录
2. ✅ 运行安装命令（只需一次）
3. ✅ 之后就可以正常使用了

每次拉取最新代码后，如果依赖有变化，可能需要重新安装。

### Q7: 安装后看不到任务怎么办？

**A:** 检查以下几点：

1. **确认包已正确导入**
   ```python
   import isaaclab_logistics_vla
   ```

2. **检查任务是否已注册**
   ```python
   import gymnasium as gym
   # 查看所有已注册的环境
   print([env_id for env_id in gym.envs.registry.keys() if "Isaac" in env_id])
   ```

3. **确认任务名称正确**
   - 任务名称应该是 `Isaac-Realman-lift` 这样的格式
   - 注意大小写和连字符

---

## ✅ 安装检查清单

安装完成后，请确认以下事项：

- [ ] IsaacLab 2.2.1 已正确安装
- [ ] 扩展包已下载/克隆到 `source/isaaclab_logistics_vla/`
- [ ] 已运行安装命令：`./isaaclab.sh -p -m pip install -e source/isaaclab_logistics_vla`
- [ ] 可以成功导入：`import isaaclab_logistics_vla`
- [ ] 可以使用 `gym.make()` 创建任务环境
- [ ] 可以运行 `random_agent.py` 脚本

---

## 🎯 下一步

安装完成后，你可以：

1. 📖 阅读 [使用指南.md](./使用指南.md) 了解如何使用扩展包
2. 🔧 阅读 [多人协作开发指南.md](./多人协作开发指南.md) 参与开发
3. 📚 阅读 [统一入口脚本使用说明.md](./统一入口脚本使用说明.md) 了解统一入口脚本
4. 🤖 查看 [Realman_Lift任务嵌入与调用详解.md](./Realman_Lift任务嵌入与调用详解.md) 了解任务结构

---

## 🔗 相关资源

- **IsaacLab 官方文档**：https://isaac-sim.github.io/IsaacLab/
- **GitHub 仓库**：https://github.com/your-org/isaaclab_logistics_vla
- **问题反馈**：在 GitHub Issues 中提交问题

---

**祝你使用愉快！** 🚀

