# ç»Ÿä¸€å…¥å£è„šæœ¬ä½¿ç”¨è¯´æ˜

## âœ… æ˜¯çš„ï¼å®Œå…¨æ”¯æŒæ‰€æœ‰å·²æ³¨å†Œçš„ä»»åŠ¡

`random_agent.py` æ˜¯ä¸€ä¸ª**é€šç”¨å…¥å£è„šæœ¬**ï¼Œæ”¯æŒæ‰€æœ‰å·²åœ¨ Gym æ³¨å†Œè¡¨ä¸­æ³¨å†Œçš„ Isaac Lab ä»»åŠ¡ã€‚

---

## ğŸš€ åŸºæœ¬ç”¨æ³•

### æ ‡å‡†å‘½ä»¤æ ¼å¼

```bash
python random_agent.py \
    --task <ä»»åŠ¡ID> \
    --num_envs <ç¯å¢ƒæ•°é‡> \
    --headless \
    --record-video <è¾“å‡ºè§†é¢‘è·¯å¾„> \
    --record-duration <å½•åˆ¶æ—¶é•¿ï¼ˆç§’ï¼‰>
```

### å®é™…ç¤ºä¾‹

```bash
# Realman æŠ“å–ä»»åŠ¡
python random_agent.py \
    --task Isaac-Realman-lift \
    --num_envs 2 \
    --headless \
    --record-video output.mp4 \
    --record-duration 10.0

# Franka å•è‡‚åˆ†æ‹£ä»»åŠ¡
python random_agent.py \
    --task Isaac-Logistics-SingleArmSorting-Franka-v0 \
    --num_envs 1 \
    --headless \
    --record-video franka_sorting.mp4

# ä»»ä½•å…¶ä»–å·²æ³¨å†Œçš„ä»»åŠ¡
python random_agent.py \
    --task Isaac-Cartpole-Direct-v0 \
    --num_envs 4 \
    --headless \
    --record-video cartpole.mp4
```

---

## ğŸ“‹ æ”¯æŒçš„å‚æ•°

### å¿…éœ€å‚æ•°

- `--task <ä»»åŠ¡ID>`ï¼šä»»åŠ¡åç§°ï¼ˆå¿…é¡»åœ¨ Gym æ³¨å†Œè¡¨ä¸­æ³¨å†Œï¼‰

### å¯é€‰å‚æ•°

#### åŸºæœ¬å‚æ•°

- `--num_envs <æ•°é‡>`ï¼šå¹¶è¡Œç¯å¢ƒæ•°é‡ï¼ˆé»˜è®¤ï¼šä½¿ç”¨ä»»åŠ¡é»˜è®¤å€¼ï¼‰
- `--disable_fabric`ï¼šç¦ç”¨ Fabric APIï¼Œä½¿ç”¨ USD I/Oï¼ˆé»˜è®¤ï¼šå¯ç”¨ Fabricï¼‰

#### è§†é¢‘å½•åˆ¶å‚æ•°

- `--record-video <è·¯å¾„>`ï¼šè¾“å‡ºè§†é¢‘æ–‡ä»¶è·¯å¾„ï¼ˆä¾‹å¦‚ï¼š`output.mp4`ï¼‰
  - å¦‚æœæŒ‡å®šï¼Œä¼šè‡ªåŠ¨å¯ç”¨ `--enable_cameras`
- `--record-duration <ç§’æ•°>`ï¼šå½•åˆ¶æ—¶é•¿ï¼ˆé»˜è®¤ï¼š10.0 ç§’ï¼‰

#### ç›¸æœºå‚æ•°

- `--camera-mode <æ¨¡å¼>`ï¼šç›¸æœºæ¨¡å¼
  - `fixed`ï¼šå›ºå®šä½ç½®ï¼ˆé»˜è®¤ï¼š`(-2.0, -0.49, 4.0)`ï¼‰
  - `orbital`ï¼šæ—‹è½¬è½¨é“è§†è§’
- `--camera-pos <X> <Y> <Z>`ï¼šè‡ªå®šä¹‰ç›¸æœºä½ç½®ï¼ˆè¦†ç›– `--camera-mode`ï¼‰

#### Isaac Sim å‚æ•°

- `--headless`ï¼šæ— å¤´æ¨¡å¼ï¼ˆæœåŠ¡å™¨è¿è¡Œï¼‰
- `--enable_cameras`ï¼šå¯ç”¨ç›¸æœºæ¸²æŸ“ï¼ˆå½•åˆ¶è§†é¢‘æ—¶è‡ªåŠ¨å¯ç”¨ï¼‰
- `--device <è®¾å¤‡>`ï¼šè®¡ç®—è®¾å¤‡ï¼ˆ`cpu` æˆ– `cuda`ï¼‰

---

## ğŸ” è„šæœ¬çš„å·¥ä½œåŸç†

### 1. è‡ªåŠ¨æ³¨å†Œæ‰€æœ‰ä»»åŠ¡

```python
# å¯¼å…¥æ ‡å‡†ä»»åŠ¡
import isaaclab_tasks  # æ³¨å†Œæ‰€æœ‰æ ‡å‡† Isaac Lab ä»»åŠ¡

# å¯¼å…¥æ‰©å±•ä»»åŠ¡
import isaaclab_logistics_vla  # æ³¨å†Œæ‰€æœ‰è‡ªå®šä¹‰ä»»åŠ¡
```

**ç»“æœ**ï¼šæ‰€æœ‰ä»»åŠ¡éƒ½å·²æ³¨å†Œåˆ° Gym æ³¨å†Œè¡¨ï¼Œå¯ä»¥é€šè¿‡ `gym.make()` åˆ›å»ºã€‚

### 2. ä»»åŠ¡éªŒè¯

```python
# æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å·²æ³¨å†Œ
if args_cli.task not in gym.envs.registry:
    print(f"[é”™è¯¯]: ä»»åŠ¡ '{args_cli.task}' æœªåœ¨Gymæ³¨å†Œè¡¨ä¸­æ‰¾åˆ°ã€‚")
    # åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ä»»åŠ¡
    isaac_tasks = [env_id for env_id in gym.envs.registry.keys() if "Isaac" in env_id]
    for task in sorted(isaac_tasks):
        print(f"  - {task}")
    return
```

**å¦‚æœä»»åŠ¡ä¸å­˜åœ¨**ï¼šè„šæœ¬ä¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ä»»åŠ¡ï¼Œå¸®åŠ©ç”¨æˆ·æ‰¾åˆ°æ­£ç¡®çš„ä»»åŠ¡IDã€‚

### 3. é€šç”¨ç¯å¢ƒåˆ›å»º

```python
# è§£æç¯å¢ƒé…ç½®ï¼ˆé€‚ç”¨äºä»»ä½• ManagerBasedRLEnv ä»»åŠ¡ï¼‰
env_cfg = parse_env_cfg(
    args_cli.task,
    device=args_cli.device,
    num_envs=args_cli.num_envs,
    use_fabric=not args_cli.disable_fabric,
)

# åˆ›å»ºç¯å¢ƒï¼ˆä½¿ç”¨æ ‡å‡†çš„ Gym APIï¼‰
env = gym.make(args_cli.task, cfg=env_cfg)
```

**å…³é”®**ï¼šä¸ä¾èµ–ä»»åŠ¡ç‰¹å®šçš„ä»£ç ï¼Œä½¿ç”¨æ ‡å‡†çš„ Isaac Lab APIã€‚

### 4. æ™ºèƒ½ç›¸æœºæ£€æµ‹

è„šæœ¬ä¼š**è‡ªåŠ¨æ£€æµ‹**å¤šç§ç›¸æœºé…ç½®ï¼š

```python
# æ–¹æ³•1: æ£€æµ‹ tiled_camera_top
if hasattr(isaac_env.scene, 'tiled_camera_top'):
    camera_data = sensor.data.output['rgb']

# æ–¹æ³•2: ä»åœºæ™¯ä¼ æ„Ÿå™¨å­—å…¸ä¸­æŸ¥æ‰¾
if camera_name in isaac_env.scene.sensors:
    camera_data = sensor.data.output['rgb']

# æ–¹æ³•3: ä»è§‚å¯Ÿç©ºé—´ä¸­è·å–å›¾åƒï¼ˆfallbackï¼‰
if 'rgb' in obs or 'image' in obs or 'camera' in obs:
    camera_data = obs['rgb']  # æˆ–å…¶ä»–é”®
```

**ç»“æœ**ï¼šå³ä½¿ä»»åŠ¡ä½¿ç”¨ä¸åŒçš„ç›¸æœºå‘½åçº¦å®šï¼Œè„šæœ¬ä¹Ÿèƒ½è‡ªåŠ¨æ‰¾åˆ°å›¾åƒã€‚

---

## âš ï¸ ä½¿ç”¨å‰ææ¡ä»¶

### âœ… ä»»åŠ¡å¿…é¡»æ»¡è¶³çš„æ¡ä»¶

1. **å·²æ³¨å†Œåˆ° Gym**ï¼šä»»åŠ¡å¿…é¡»é€šè¿‡ `gym.register()` æ³¨å†Œ
2. **åŸºäº ManagerBasedRLEnv**ï¼šä½¿ç”¨æ ‡å‡†çš„ Isaac Lab ç¯å¢ƒåŸºç±»
3. **æ”¯æŒ parse_env_cfg()**ï¼šé…ç½®ç±»å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²è·¯å¾„è§£æ

### ğŸ“¹ è§†é¢‘å½•åˆ¶çš„å‰ææ¡ä»¶

ä¸ºäº†æˆåŠŸå½•åˆ¶è§†é¢‘ï¼Œä»»åŠ¡æœ€å¥½æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼š

#### é€‰é¡¹ Aï¼šåœºæ™¯ä¸­æœ‰ç›¸æœºï¼ˆæ¨èï¼‰

```python
# åœ¨ä»»åŠ¡çš„åœºæ™¯é…ç½®ä¸­
@configclass
class MySceneCfg(InteractiveSceneCfg):
    tiled_camera_top = TiledCameraCfg(...)  # è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹
    # æˆ–
    top_camera = CameraCfg(...)
    # æˆ–
    camera = CameraCfg(...)
```

#### é€‰é¡¹ Bï¼šè§‚å¯Ÿç©ºé—´åŒ…å«å›¾åƒ

```python
# åœ¨ä»»åŠ¡çš„è§‚å¯Ÿé…ç½®ä¸­
@configclass
class ObservationsCfg:
    @configclass
    class PolicyCfg(ObsGroup):
        rgb = ObsTerm(func=mdp.generated_commands, ...)  # æˆ–å…¶ä»–å›¾åƒè§‚å¯Ÿ
        # è§‚å¯Ÿé”®å¯ä»¥æ˜¯ï¼š'rgb', 'image', 'camera', 'policy' ç­‰
```

**æ³¨æ„**ï¼šå¦‚æœä»»åŠ¡æ—¢æ²¡æœ‰ç›¸æœºé…ç½®ï¼Œè§‚å¯Ÿç©ºé—´ä¹Ÿæ²¡æœ‰å›¾åƒï¼Œè„šæœ¬ä¼šå°è¯•ä»è§‚å¯Ÿç©ºé—´ä¸­æŸ¥æ‰¾ï¼Œä½†å¯èƒ½æ‰¾ä¸åˆ°å›¾åƒã€‚

---

## ğŸ“ ç¤ºä¾‹ï¼šæŸ¥çœ‹æ‰€æœ‰å¯ç”¨ä»»åŠ¡

å¦‚æœä½ ä¸ç¡®å®šæœ‰å“ªäº›ä»»åŠ¡å¯ç”¨ï¼Œå¯ä»¥è¿è¡Œï¼š

```bash
python random_agent.py --task nonexistent-task
```

è„šæœ¬ä¼šè¾“å‡ºæ‰€æœ‰å·²æ³¨å†Œçš„ Isaac ä»»åŠ¡ï¼š

```
[é”™è¯¯]: ä»»åŠ¡ 'nonexistent-task' æœªåœ¨Gymæ³¨å†Œè¡¨ä¸­æ‰¾åˆ°ã€‚
[æç¤º]: å¯ç”¨çš„ä»»åŠ¡åˆ—è¡¨:
  - Isaac-Cartpole-Direct-v0
  - Isaac-Humanoid-Direct-v0
  - Isaac-Realman-lift
  - Isaac-Logistics-SingleArmSorting-Franka-v0
  ...
```

---

## ğŸ¯ å®é™…ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šå¿«é€Ÿæµ‹è¯•æ–°ä»»åŠ¡

```bash
# åˆ›å»ºäº†æ–°ä»»åŠ¡å¹¶æ³¨å†Œåï¼Œç«‹å³æµ‹è¯•
python random_agent.py \
    --task Isaac-MyNewTask-v0 \
    --num_envs 1 \
    --headless \
    --record-video test.mp4
```

### åœºæ™¯ 2ï¼šæ‰¹é‡å½•åˆ¶å¤šä¸ªä»»åŠ¡

```bash
# åˆ›å»ºä¸€ä¸ªè„šæœ¬å¾ªç¯æ‰€æœ‰ä»»åŠ¡
for task in "Isaac-Realman-lift" "Isaac-Logistics-SingleArmSorting-Franka-v0"; do
    python random_agent.py \
        --task "$task" \
        --num_envs 1 \
        --headless \
        --record-video "${task}.mp4" \
        --record-duration 5.0
done
```

### åœºæ™¯ 3ï¼šè°ƒè¯•ç›¸æœºè§†è§’

```bash
# ä½¿ç”¨è‡ªå®šä¹‰ç›¸æœºä½ç½®
python random_agent.py \
    --task Isaac-Realman-lift \
    --headless \
    --record-video debug.mp4 \
    --camera-pos 3.0 2.0 5.0
```

### åœºæ™¯ 4ï¼šæ—‹è½¬è½¨é“è§†è§’

```bash
# ä½¿ç”¨æ—‹è½¬è½¨é“è§†è§’ï¼Œå±•ç¤ºåœºæ™¯å…¨æ™¯
python random_agent.py \
    --task Isaac-Realman-lift \
    --headless \
    --record-video orbital.mp4 \
    --camera-mode orbital \
    --record-duration 20.0
```

---

## ğŸ”§ é«˜çº§åŠŸèƒ½

### åŠ¨æ€ç›¸æœºè°ƒæ•´

è„šæœ¬æ”¯æŒåœ¨è¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´ç›¸æœºä½ç½®ï¼ˆä»…åœ¨ `orbital` æ¨¡å¼ä¸‹ï¼‰ï¼š

- ç›¸æœºå›´ç»•åœºæ™¯ä¸­å¿ƒæ—‹è½¬
- è‡ªåŠ¨è®¡ç®— `look-at` æ–¹å‘
- å®æ—¶æ›´æ–°ç›¸æœºä½å§¿

### æ–‡æœ¬å åŠ 

è§†é¢‘ä¸­è‡ªåŠ¨å åŠ ä»¥ä¸‹ä¿¡æ¯ï¼š

- å½“å‰æ­¥æ•° / æ€»æ­¥æ•°
- ç›¸æœºä½ç½®
- ç›¸æœºæ¨¡å¼
- æ—‹è½¬è§’åº¦ï¼ˆorbital æ¨¡å¼ï¼‰
- æœºå™¨äººä½ç½®å’Œæ—‹è½¬ï¼ˆå¦‚æœå¯è·å–ï¼‰

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä»»åŠ¡æ²¡æœ‰ç›¸æœºï¼Œèƒ½å½•åˆ¶è§†é¢‘å—ï¼Ÿ

**A**: è„šæœ¬ä¼šå°è¯•ä»è§‚å¯Ÿç©ºé—´ä¸­è·å–å›¾åƒã€‚å¦‚æœè§‚å¯Ÿç©ºé—´åŒ…å«å›¾åƒï¼ˆå¦‚ `obs['rgb']`ï¼‰ï¼Œä»ç„¶å¯ä»¥å½•åˆ¶ã€‚ä½†å¦‚æœæ²¡æœ‰å›¾åƒï¼Œè§†é¢‘å¯èƒ½ä¸ºç©ºã€‚

### Q2: ä»»åŠ¡è¿è¡Œå¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: 
1. æ£€æŸ¥ä»»åŠ¡æ˜¯å¦æ­£ç¡®æ³¨å†Œï¼š`python random_agent.py --task YourTask-v0`
2. æ£€æŸ¥ä»»åŠ¡æ˜¯å¦åŸºäº `ManagerBasedRLEnv`
3. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´ä»»åŠ¡é…ç½®

### Q3: å¦‚ä½•ä¸ºä»»åŠ¡æ·»åŠ ç›¸æœºæ”¯æŒï¼Ÿ

**A**: åœ¨ä»»åŠ¡çš„åœºæ™¯é…ç½®ä¸­æ·»åŠ ç›¸æœºï¼š

```python
@configclass
class MySceneCfg(InteractiveSceneCfg):
    tiled_camera_top = TiledCameraCfg(
        prim_path="{ENV_REGEX_NS}/camera",
        height=720,
        width=1280,
        data_types=["rgb"],
        # ... å…¶ä»–é…ç½®
    )
```

### Q4: è„šæœ¬èƒ½å¦ç”¨äºè®­ç»ƒï¼Ÿ

**A**: è¿™ä¸ªè„šæœ¬ä¸»è¦ç”¨äº**æµ‹è¯•å’Œå½•åˆ¶è§†é¢‘**ï¼Œä½¿ç”¨éšæœºåŠ¨ä½œã€‚å¦‚æœè¦è®­ç»ƒï¼Œè¯·ä½¿ç”¨ä¸“é—¨çš„è®­ç»ƒè„šæœ¬ï¼ˆå¦‚ `rsl_rl`, `skrl` ç­‰ï¼‰ã€‚

---

## ğŸ“Š æ€»ç»“

âœ… **å®Œå…¨æ”¯æŒæ‰€æœ‰å·²æ³¨å†Œçš„ä»»åŠ¡**  
âœ… **è‡ªåŠ¨æ£€æµ‹ç›¸æœºé…ç½®**  
âœ… **æ™ºèƒ½å›¾åƒè·å–ï¼ˆå¤šç§fallbackæœºåˆ¶ï¼‰**  
âœ… **çµæ´»çš„è§†é¢‘å½•åˆ¶é€‰é¡¹**  
âœ… **æ— éœ€ä¿®æ”¹è„šæœ¬å³å¯æ”¯æŒæ–°ä»»åŠ¡**  

**åªè¦ä»»åŠ¡æ»¡è¶³åŸºæœ¬è¦æ±‚ï¼ˆæ³¨å†Œ + ManagerBasedRLEnvï¼‰ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªç»Ÿä¸€å…¥å£è„šæœ¬ï¼**

